#!/bin/bash

# Function to get Music app track info
get_music_track() {
  osascript -l JavaScript <<EOF
  let output = "";

try {
  if (Application("Music").running()) {
    try {
      const track = Application("Music").currentTrack;
      const artist = track.artist();
      const title = track.name();
      output = \`\${title} - \${artist}\`.substr(0, 50);
    } catch (e) {
      // Handle case where track info can't be accessed
    }
  }
} catch (e) {
  // Music app not found, try Spotify
}

output;
EOF
}

# Try to get track info
track_info=$(get_music_track)

# Output the result
if [ -n "$track_info" ]; then
  echo "$track_info"
fi
